---
title: "Tarea 4"
author: "Ian Azofeifa Flores, Kenneth Barrantes Fallas, Marvin Muñoz Zamora"
date: "19/11/2020"
output: html_document
---

## Llamar datos

```{r}
Tarea4 <- read.csv("Datos_tarea4.csv", sep = ",")

A.factor <- as.factor(Tarea4$A)
levels(A.factor)

P.factor <-as.factor(Tarea4$P)
levels(P.factor)
```

## Supuestos parametricas

### Prueba de normalidad 
```{r}
D.test <- shapiro.test(Tarea4$D) # Prueba Shapiro para normalidad
print(D.test)

plotn <- function(x,main="Histograma de frecuencias \ny distribuci?n normal",
                  xlab="D",ylab="Variabilidad") {
  min <- min(x)
  max <- max(x)
  media <- mean(x)
  dt <- sd(x)
  hist(x,freq=F,main=main,xlab=xlab,ylab=ylab)
  curve(dnorm(x,media,dt), min, max,add = T,col="blue")
}

```

### Se realiza un gráfico de distribución para los datos


```{r}
plotn(Tarea4$D,main="Distribuci?n normal") # Grafico distribución

```

### Prueba de varianzas 

```{r}
bartlett.test(Tarea4$D ~ Tarea4$A)  # Hay diferencia entre las varianzas 
bartlett.test(Tarea4$D ~ Tarea4$P)  # No hay diferencia entre las varianzas
bartlett.test(Tarea4$D ~ Tarea4$L)  # Hay diferencia entre las varianzas
bartlett.test(Tarea4$D ~ Tarea4$H1) # No hay diferencia entre las varianzas
bartlett.test(Tarea4$D ~ Tarea4$H2) # Hay diferencia entre las varianzas
bartlett.test(Tarea4$D ~ Tarea4$H3) # Hay diferencia entre las varianzas
bartlett.test(Tarea4$D ~ Tarea4$H4) # No hay diferencia entre las varianzas
bartlett.test(Tarea4$D ~ Tarea4$H5) # Hay diferencia entre las varianzas

```

### Homocedasticidad

```{r}
library(car) # Para homocedasticidad
leveneTest(Tarea4$D ~ A.factor) # Si diferencia significativa para variables entre los grupos
leveneTest(Tarea4$D ~ P.factor) # No diferencia significativa para las variables en los grupos
```

Según supuestos no se pueden realizar pruebas paramétricas


## Análisis estadístico

Como son conteos y distribucion tiende a ser quasipoisson se realiza regresion lineal de quasipoisson por separado para cada variable predictora con respecto a D.

```{r}
# Como son conteos y distribucion tiende a ser poisson se realiza regresion lineal de quasipoisson
# para todas las variables

modelo_glmA <- glm(D ~ A, data = Tarea4, family = quasipoisson)
summary(modelo_glmA)

modelo_glmP <- glm(D ~ P, data = Tarea4, family = quasipoisson)
summary(modelo_glmP)

modelo_glmL <- glm(D ~ L, data = Tarea4, family = quasipoisson)
summary(modelo_glmL)

modelo_glmH1 <- glm(D ~ H1, data = Tarea4, family = quasipoisson)
summary(modelo_glmH1)

modelo_glmH2 <- glm(D ~ H2, data = Tarea4, family = quasipoisson)
summary(modelo_glmH2)

modelo_glmH3 <- glm(D ~ H3, data = Tarea4, family = quasipoisson)
summary(modelo_glmH3)

modelo_glmH4 <- glm(D ~ H4, data = Tarea4, family = quasipoisson)
summary(modelo_glmH4)

modelo_glmH5 <- glm(D ~ H5, data = Tarea4, family = quasipoisson)
summary(modelo_glmH5)

```

Para un intervalo de confianza del 95%, la variable respuesta muestra dependencia ante todas las variables predictoras. En cada modelo se agregan valores de sobredispersión.

### Modelos extra
Regresiones de Poison con variable respuesta P 

```{r}

modelo_glmP1 <- glm(P ~ H1, data = Tarea4, family = quasipoisson)
summary(modelo_glmP1)

modelo_glmP2 <- glm(P ~ H2, data = Tarea4, family = quasipoisson)
summary(modelo_glmP2)

modelo_glmP3 <- glm(P ~ H3, data = Tarea4, family = quasipoisson)
summary(modelo_glmP3)

modelo_glmP4 <- glm(P ~ H4, data = Tarea4, family = quasipoisson)
summary(modelo_glmP4)

modelo_glmP5 <- glm(P ~ H5, data = Tarea4, family = quasipoisson)
summary(modelo_glmP5)


```

Regresiones de Poison con variable respuesta A

```{r}

modelo_glmA1 <- glm(A ~ H1, data = Tarea4, family = quasipoisson)
summary(modelo_glmA1)

modelo_glmA2 <- glm(A ~ H2, data = Tarea4, family = quasipoisson)
summary(modelo_glmA2)

modelo_glmA3 <- glm(A ~ H3, data = Tarea4, family = quasipoisson)
summary(modelo_glmA3)

modelo_glmA4 <- glm(A ~ H4, data = Tarea4, family = quasipoisson)
summary(modelo_glmA4)

modelo_glmA5 <- glm(A ~ H5, data = Tarea4, family = quasipoisson)
summary(modelo_glmA5)


```


Agregamos modelos de regresion lineal de quasipoisson usando P y A como variables respuesta frente a variables predictoras ambientales (h1, h2, h3, h4, h5). De este análisis se obtine para un 95% de confianza que todos los factores ambientales afectan la distribución de P y que para A solamente lo hacen h2, h3 y h4. En cada modelo se agregan valores de sobredispersión.

---
### Información de sesión
```{r session, echo=FALSE}
sessionInfo() # Información de la sesión
```